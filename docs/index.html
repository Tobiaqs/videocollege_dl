<!DOCTYPE html>
<html>
<head>
	<title>Bookmarklet videocollege_dl</title>
	<style>
	body {
		font-family: sans-serif;
	}

	a {
		display: inline-block;
		padding: 16px;
		background-color: #81DAF7;

		color: white;
	}
	</style>
</head>
<body>
	<!-- Bookmarklet created via http://mrcoles.com/bookmarklet/ -->
	Drag this to your bookmarks:<br><br>
	<a href="javascript:(function()%7B(function%20()%20%7Bfunction%20download%20(payload%2C%20callback)%20%7Bfetch(%22%2FMediasite%2FPlayerService%2FPlayerService.svc%2Fjson%2FGetPlayerOptions%22%2C%20%7Bmethod%3A%20%22POST%22%2Cheaders%3A%20%7B%22Content-Type%22%3A%20%22application%2Fjson%22%7D%2Cbody%3A%20JSON.stringify(payload)%2Ccredentials%3A%20%22include%22%7D).then((response)%20%3D%3E%20%7Breturn%20response.json()%3B%7D%2C%20(error)%20%3D%3E%20%7Balert(%22An%20error%20occurred.%20See%20console%20for%20details.%22)%3Bconsole.log(error)%3B%7D).then((json)%20%3D%3E%20%7Bif%20(!json%20%7C%7C%20!json.d%20%7C%7C%20!json.d.Presentation%20%7C%7C%20!json.d.Presentation.Streams)%20%7Balert(%22Unusable%20data%20received.%20See%20console%20for%20a%20dump.%22)%3Bconsole.log(json)%3Breturn%3B%7Dlet%20stream%20%3D%20json.d.Presentation.Streams.find((stream)%20%3D%3E%20%7Breturn%20stream.VideoUrls.length%20%3E%200%3B%7D)%3Bif%20(!stream)%20%7Balert(%22No%20video%20stream%20found.%22)%3Breturn%3B%7Dif%20(callback)%20%7Bcallback(stream.VideoUrls%5B0%5D.Location%2C%20json.d.Presentation.Title)%3B%7D%20else%20%7Blet%20a%20%3D%20document.createElement('A')%3Ba.download%20%3D%20json.d.Presentation.Title%3Ba.href%20%3D%20stream.VideoUrls%5B0%5D.Location%3Bdocument.body.appendChild(a)%3Ba.click()%3B%7D%7D)%3B%7D%3Bif%20(location.pathname.indexOf(%22%2FMediasite%2FCatalog%2FFull%2F%22)%20%3D%3D%3D%200%20%26%26%20!window._videocollege_dl_enabled)%20%7Bwindow._videocollege_dl_enabled%20%3D%20true%3Blet%20cache%20%3D%20%7B%7D%3BsetInterval(()%20%3D%3E%20%7Blet%20title%20%3D%20document.getElementById(%22SearchResultsTitle%22)%3Bif%20(title.children.length%20%3D%3D%3D%200)%20%7Blet%20a%20%3D%20document.createElement('A')%3Ba.addEventListener(%22click%22%2C%20()%20%3D%3E%20%7Blet%20elements%20%3D%20document.getElementsByClassName(%22navPanel%22)%3Blet%20descriptors%20%3D%20%5B%5D%3Bfor%20(let%20element%20of%20elements)%20%7Blet%20path%20%3D%20element.children%5B1%5D.href.split('%2F').reverse()%5B0%5D%3Bif%20(cache%5Bpath%5D)%20%7Bdescriptors.push(cache%5Bpath%5D)%3B%7D%7Dif%20(descriptors.length%20!%3D%3D%20elements.length)%20%7Balert(%22Not%20all%20download%20links%20fetched%20for%20this%20page.%20Try%20again%20in%20a%20few%20seconds.%22)%3Breturn%3B%7Dlet%20script%20%3D%20''%3Bdescriptors.forEach((descriptor)%20%3D%3E%20%7Blet%20ext%20%3D%20descriptor.url.match(%2F%5C.(.%7B3%7D)%5C%3F%2F)%5B1%5D%3Bscript%20%2B%3D%20'wget%20-O%20%22'%20%2B%20descriptor.title%20%2B%20'.'%20%2B%20ext%20%2B%20'%22%20%22'%20%2B%20descriptor.url%20%2B%20'%22%5Cn'%3B%7D)%3Bconsole.log(script)%3Blet%20a%20%3D%20document.createElement('a')%3Blet%20objectURL%20%3D%20URL.createObjectURL(new%20Blob(%5Bscript%5D%2C%20%7B%20type%3A%20%22text%2Fplain%22%20%7D))%3Ba.href%20%3D%20objectURL%3Ba.download%20%3D%20%22lectures.sh%22%3B%2F%2F%20Append%20anchor%20to%20body.document.body.appendChild(a)%3Ba.click()%3BURL.revokeObjectURL(objectURL)%2F%2F%20Remove%20anchor%20from%20bodydocument.body.removeChild(a)%3B%7D)%3Ba.innerHTML%20%3D%20%22%20(wget%20script)%22%3Btitle.appendChild(a)%3B%7Dlet%20elements%20%3D%20document.getElementsByClassName(%22navPanel%22)%3Bfor%20(let%20element%20of%20elements)%20%7Bif%20(element.children.length%20%3D%3D%3D%202%20%26%26%20!element.getAttribute(%22data-fetched%22))%20%7Belement.setAttribute(%22data-fetched%22%2C%20%22yes%22)%3Blet%20path%20%3D%20element.children%5B1%5D.href.split('%2F').reverse()%5B0%5D%3Blet%20queryString%20%3D%20path.match(%2F%5C%3Fcatalog%3D(%5B%5E%26%5D%2B)%2F)%5B1%5D%3Bif%20(cache%5Bpath%5D)%20%7BcreateDownloadLink(cache%5Bpath%5D.url%2C%20cache%5Bpath%5D.title)%3Bcontinue%3B%7Dlet%20payload%20%3D%20%7BgetPlayerOptionsRequest%3A%20%7BResourceId%3A%20path.split('%3F')%5B0%5D%2CQueryString%3A%20queryString%2CUseScreenReader%3A%20false%2CUrlReferrer%3A%20location.href%7D%7D%3Bdownload(payload%2C%20createDownloadLink)%3Bfunction%20createDownloadLink%20(url%2C%20title)%20%7Bif%20(!cache%5Bpath%5D)%20%7Bcache%5Bpath%5D%20%3D%20%7Burl%3A%20url%2Ctitle%3A%20title%7D%3B%7Dlet%20a%20%3D%20document.createElement(%22A%22)%3Ba.href%20%3D%20url%3Ba.innerHTML%20%3D%20%22Download%22%3Ba.download%20%3D%20title%3Ba.target%20%3D%20%22_blank%22%3Belement.appendChild(a)%3B%7D%3B%7D%7D%7D%2C%201000)%3B%7D%20else%20if%20(location.pathname.indexOf(%22%2FMediasite%2FPlay%2F%22))%20%7Blet%20payload%20%3D%20%7BgetPlayerOptionsRequest%3A%20%7BResourceId%3A%20location.pathname.split('%2F').reverse()%5B0%5D%2CQueryString%3A%20location.search%2CUseScreenReader%3A%20false%2CUrlReferrer%3A%20document.referrer%7D%7D%3Bdownload(payload)%3B%7D%7D)()%7D)()">Videocollege DL</a>
</body>
</html>
