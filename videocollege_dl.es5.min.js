"use strict";(function(){function download(d,e){fetch("/Mediasite/PlayerService/PlayerService.svc/json/GetPlayerOptions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(d),credentials:"include"}).then(function(a){return a.json()},function(a){alert("An error occurred. See console for details.");console.log(a)}).then(function(b){if(!b||!b.d||!b.d.Presentation||!b.d.Presentation.Streams){alert("Unusable data received. See console for a dump.");console.log(b);return}var c=b.d.Presentation.Streams.find(function(a){return a.VideoUrls.length>0});if(!c){alert("No video stream found.");return}if(e){e(c.VideoUrls[0].Location,b.d.Presentation.Title)}else{var a=document.createElement('A');a.download=b.d.Presentation.Title;a.href=c.VideoUrls[0].Location;document.body.appendChild(a);a.click()}})};if(location.pathname.indexOf("/Mediasite/Catalog/Full/")===0&&!window._videocollege_dl_enabled){window._videocollege_dl_enabled=true;var v={};setInterval(function(){var n=document.getElementById("SearchResultsTitle");if(n.children.length===0){var a=document.createElement('A');a.addEventListener("click",function(){var c=document.getElementsByClassName("navPanel");var d=[];var e=true;var f=false;var g=undefined;try{for(var h=c[Symbol.iterator](),_step;!(e=(_step=h.next()).done);e=true){var i=_step.value;var j=[].find.call(i.children,function(a){return a.id==="Launch"});var k=j.href.split('/').reverse()[0];if(v[k]){d.push(v[k])}}}catch(err){f=true;g=err}finally{try{if(!e&&h.return){h.return()}}finally{if(f){throw g;}}}if(d.length!==c.length){alert("Not all download links fetched for this page. Try again in a few seconds.");return}var l='#!/bin/bash\n';d.forEach(function(a){var b=a.url.match(/\.(.{3})\?/)[1];l+='wget -O "'+a.title+'.'+b+'" "'+a.url+'"\n'});var a=document.createElement('a');var m=URL.createObjectURL(new Blob([l],{type:"text/plain"}));a.href=m;a.download="lectures.sh";document.body.appendChild(a);a.click();URL.revokeObjectURL(m);document.body.removeChild(a)});a.innerHTML=" (wget script)";n.appendChild(a)}var o=document.getElementsByClassName("navPanel");var p=true;var q=false;var r=undefined;try{var s=function s(){var d=_step2.value;var e=[].some.call(d,function(a){return a.id==="Download"});if(!e&&!d.getAttribute("data-fetched")){var f=function f(b,c){if(!v[h]){v[h]={url:b,title:c}}var a=document.createElement("A");a.href=b;a.innerHTML="Download";a.download=c;a.target="_blank";a.id="Download";d.appendChild(a)};d.setAttribute("data-fetched","yes");var g=[].find.call(d.children,function(a){return a.id==="Launch"});var h=g.href.split('/').reverse()[0];var i=h.match(/\?catalog=([^&]+)/)[1];if(v[h]){f(v[h].url,v[h].title);return"continue"}var j={getPlayerOptionsRequest:{ResourceId:h.split('?')[0],QueryString:i,UseScreenReader:false,UrlReferrer:location.href}};download(j,f)}};for(var t=o[Symbol.iterator](),_step2;!(p=(_step2=t.next()).done);p=true){var u=s();if(u==="continue")continue}}catch(err){q=true;r=err}finally{try{if(!p&&t.return){t.return()}}finally{if(q){throw r;}}}},1000)}else if(location.pathname.indexOf("/Mediasite/Play/")){var w={getPlayerOptionsRequest:{ResourceId:location.pathname.split('/').reverse()[0],QueryString:location.search,UseScreenReader:false,UrlReferrer:document.referrer}};download(w)}})();